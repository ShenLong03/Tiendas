@model Tienda.Models.VentaViewModel

@{
    /**/

    ViewBag.Title = "Details";
}
<style>
    h2, h4, th, dt, label, a {
        color: white;
        text-shadow: 1px 1px 2px white, 0 0 25px blue, 0 0 5px White;
    }

    td, dd {
        color: white;
        text-shadow: 2px 2px 5px white;
    }

    #Bordear {
        border-radius: 50%;
    }

    a:hover {
        color: white;
    }

    #Bordear:hover {
        box-shadow: 0 12px 16px 0 rgba(0,0,0,0.24), 0 17px 50px 0 rgba(0,0,0,0.19);
        font-size: 15px;
    }
</style>
<h2>Detalles Factura  # @Model.VentaId</h2>

<hr />



@if (ViewBag.Mensaje != null)
{
    <div class="alert alert-danger">
        @ViewBag.Mensaje
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>

}


<div>

    <dl class="dl-horizontal">
        <dt>
           Nombre Cliente
        </dt>

        <dd>
            @Html.DisplayFor(model => model.Nombre)
        </dd>

        <dt>
           Fecha Orden
        </dt>

        <dd>
            @Html.DisplayFor(model => model.Fecha)
        </dd>

        <dt>
           Total Orden
        </dt>

        <dd>
            @Html.DisplayFor(model => model.TotalOrden)
        </dd>



    </dl>
</div>
<p>
    @Html.ActionLink("Editar Factura", "Edit", new { id = Model.VentaId }, new { @class = "btn btn-warning", @id = "Bordear" }) |
    @Html.ActionLink("Volver Lista Facturas", "Index",new { }, new { @class = "btn btn-info", @id = "Bordear" })
</p>

<hr />
@{
    Html.RenderAction("CreateDetalleVentaPartial", new { id = Model.VentaId } );
}
<hr />
<table class="table">
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.DetalleVentas.FirstOrDefault().Productos.Descripcion)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.DetalleVentas.FirstOrDefault().Ventas.Nombre)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.DetalleVentas.FirstOrDefault().Precio)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.DetalleVentas.FirstOrDefault().Cantidad)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.DetalleVentas.FirstOrDefault().Descuento)
        </th>
        <th>Subtotal</th>
        <th></th>
    </tr>

    @foreach (var item in Model.DetalleVentas)
    {
        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.Productos.Descripcion)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Ventas.Nombre)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Precio)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Cantidad)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Descuento)
            </td>
            <td>
                @item.Subtotal.ToString("C2")
            </td>
            <td>
                @Html.ActionLink("Editar Detalle Venta", "EditDetalleVenta", new { id = item.DetalleVentasId }, new { @class = "btn btn-warning", @id = "Bordear" }) |
                @Html.ActionLink("Ver Detalle Venta", "DetailsDetalleVenta", new { id = item.DetalleVentasId }, new { @class = "btn btn-info", @id = "Bordear" }) |
                @Html.ActionLink("Borar Detalle Venta", "DeleteDetalleVenta", new { id = item.DetalleVentasId }, new { @class = "btn btn-danger", @id = "Bordear" })
            </td>
        </tr>
    }

</table>
<hr />
<div class="row">
    <div class="form-horizontal col-md-5">


        <div class="form-group">
            @Html.LabelFor(model => model.TotalBruto, "TotalBruto", htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.TotalBruto, new { htmlAttributes = new { @class = "form-control", @disabled = "disabled" } })

            </div>
        </div>
        <div class="form-group">
            @Html.LabelFor(model => model.TotalNeto,"TotalNeto", htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.TotalNeto, new { htmlAttributes = new { @class = "form-control", @disabled = "disabled" } })

            </div>
        </div>

    </div>


</div>

<!-- Trigger the modal with a button -->
<button type="button" class="btn btn-info" id="Bordear" data-toggle="modal" data-target="#myModal">Pagar Factura</button>

<!-- Modal -->
<div id="myModal" class="modal fade" role="dialog">
    <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                
                <h4 class="modal-title"align="center">Pago</h4>
               
            </div>
            <div class="modal-body">
                @{Html.RenderAction("CreatePago", new { id = Model.VentaId }); }
            </div>
            <div class="modal-footer">
                <button type="button" id="Bordear" class="btn btn-danger" data-dismiss="modal">Cerrar</button>
            </div>
        </div>

    </div>
</div>




@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")

    <script>


                    $(document).ready(function () {


                        $("#ProductoId").val("");
                        $("#ProductoId").focus();


                    });




       

        $("#prueba").click(function () {
            $(this).hide();
           
            });

   










    </script>

<script type="text/javascript">

                                    debugger;
                                $('#Monto').keyup(function () {
                                    if ($('#Monto').val() == '' || $('#Monto').val() == '0') {

                $('Vuelto').val(0);
            return;
        }
        var vuelto = parseInt($('#Monto').val()) - parseInt($('#TotalNeto').val());
        $('#Vuelto').val(vuelto.toString());
});
</script>

}

